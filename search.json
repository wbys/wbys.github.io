[{"title":"Double转Bigdecimal精度问题","url":"http://iwbys.com/2017/08/10/Double2Bigdecimal/","content":"<h2 id=\"遇到一个bug\"><a href=\"#遇到一个bug\" class=\"headerlink\" title=\"遇到一个bug\"></a>遇到一个bug</h2><p>今天项目里遇到一个bug，前端传过来的二位小数值，结果存到数据库变了，”123.56”变成了”123.55”，就debug跟了一下结果发现了问题，简单描述一下。</p>\n<blockquote>\n<p>后端接收参数是用的Double类型，接下来有个操作要转成转成Bigdecimal </p>\n<p>参数：</p>\n<pre><code>private Double area;\n</code></pre><p>操作：</p>\n<pre><code>UpdateRequest request = new UpdateRequest();\nrequest.setArea(new BigDecimal(area));\nSystem.out.println(new ObjectMapper().writeValueAsString(request));\n</code></pre><p>然后打印出来结果是：</p>\n<pre><code>{&quot;area&quot;:789.55999999999994543031789362430572509765625}\n</code></pre></blockquote>\n<p>一脸懵逼不知道为什么这样。想了一下应该是精度的问题，查了下资料是Double转BigDecimal构造函数的bug</p>\n<pre><code>public BigDecimal(double val) {\n    this(val,MathContext.UNLIMITED);\n}\n</code></pre><h2 id=\"解决方法\"><a href=\"#解决方法\" class=\"headerlink\" title=\"解决方法\"></a>解决方法</h2><p>因为项目里是2位小数，查到一个简单的解决方法</p>\n<blockquote>\n<p>先把Double转String，然后再用String转BigDecimal的构造函数。</p>\n</blockquote>\n<pre><code>public class Double2Bigdecimal {\n\n    public static void main(String[] args) throws JsonProcessingException {\n\n        Double area = 789.56;\n\n        UpdateRequest request = new UpdateRequest();\n        request.setArea(new BigDecimal(area));\n        System.out.println(new ObjectMapper().writeValueAsString(request));\n    }\n\n\n    public static class UpdateRequest{\n        private BigDecimal area;\n\n        public BigDecimal getArea() {\n            return area;\n        }\n\n        public void setArea(BigDecimal area) {\n            this.area = area;\n        }\n    }\n}\n</code></pre><h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>所以最好别用这个构造函数，应该使用</p>\n<pre><code>public BigDecimal(String val) {\n    this(val.toCharArray(), 0, val.length());\n}\n</code></pre>","categories":[],"tags":[]},{"title":"朝生暮死","url":"http://iwbys.com/2017/06/05/zsms/","content":"<h4 id=\"期待着每个周末-在周末活下来-到周一死去-我放弃了-人不能一直活在期待里\"><a href=\"#期待着每个周末-在周末活下来-到周一死去-我放弃了-人不能一直活在期待里\" class=\"headerlink\" title=\"期待着每个周末  在周末活下来  到周一死去  我放弃了  人不能一直活在期待里\"></a>期待着每个周末  在周末活下来  到周一死去  我放弃了  人不能一直活在期待里</h4>","categories":[],"tags":[]},{"title":"Start from zero","url":"http://iwbys.com/2017/05/25/firstblog/","content":"<h3 id=\"welcome-to-my-blog\"><a href=\"#welcome-to-my-blog\" class=\"headerlink\" title=\"welcome to my blog!!!\"></a>welcome to my blog!!!</h3><p>搞了3天终于把博客搞定了  然后换了一个喜欢的主题   虽然还不懂markdown语法  也终于可以开始写自己的博客了  随便写写记录生活、技术  Start from zero老哥</p>\n<p>参考了博客：<br><a href=\"http://www.jianshu.com/p/e99ed60390a8\" target=\"_blank\" rel=\"external\">20分钟教你使用hexo搭建github博客</a></p>\n<p><a href=\"http://www.jianshu.com/p/465830080ea9\" target=\"_blank\" rel=\"external\">HEXO+Github,搭建属于自己的博客</a>  </p>\n<p>theme:<br><a href=\"https://github.com/hexojs/hexo/wiki/Themes\" target=\"_blank\" rel=\"external\">hexo themes</a></p>\n","categories":[],"tags":[]},{"title":"about","url":"http://iwbys.com/about/index.html","content":"","categories":[],"tags":[]},{"title":"category","url":"http://iwbys.com/category/index.html","content":"","categories":[],"tags":[]},{"title":"link","url":"http://iwbys.com/link/index.html","content":"","categories":[],"tags":[]},{"title":"project","url":"http://iwbys.com/project/index.html","content":"","categories":[],"tags":[]},{"title":"search","url":"http://iwbys.com/search/index.html","content":"","categories":[],"tags":[]},{"title":"tag","url":"http://iwbys.com/tag/index.html","content":"","categories":[],"tags":[]}]